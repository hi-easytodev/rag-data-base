<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# Инструкция: Локальный и бесплатный парсинг документов в данные для ИИ с помощью Docling (и Docling Serve + Hybrid Chunking через n8n)

## Общее описание

Документация подготовлена по двум видео:

- [Преврати ЛЮБОЙ Документ в Данные для ИИ Локально и Бесплатно (Docling, Парсинг)](https://youtu.be/tawFHMNF-T8?si=9W-oEEI_zsSs8zlI)
- [Парсим ВСЕ Файлы в Данные для ИИ Бесплатно Через N8N (Docling API, RAG, Hybrid chunking)](https://youtu.be/CRNgrCZkpZE?si=f8sGT4ItZQAK3CWw)

Доклинг — это open-source-фреймворк для локального (или изолированного корпоративного) парсинга любых документов (PDF, DOCX, HTML), преобразования таблиц, списков, графиков и изображений в чистый структурированный Markdown/JSON/“чанки” для последующей векторизации и загрузки в базы знаний или RAG-системы. Принципиальное отличие — всё работает приватно, без утечек данных и оплаты облачных AI API.

***

## Краткие выводы о Docling (видео №1)

### Важные особенности Docling

- **Открытый код, локальная работа (GitHub: https://github.com/doclingproject/docling)**
- Поддержка форматов: PDF, DOCX, HTML, таблицы, графики, изображения (с позициями, описаниями)
- Полностью оффлайн/безопасно: приватные/корпоративные документы не покидают компьютер
- Архитектура из парсеров “по типу документа”
- Строго структурированная логика: объекты документа объединяются в логические блоки (list, table, section и др)
- Итог: парсер выдаёт корректный Markdown или JSON с “правильными” чанками для умной векторизации


### Пример простого парсинга

```python
from docling import Converter

conv = Converter()
result = conv.read('input/sample.pdf')
print(result['markdown'])
```

- На выходе Markdown: списки, таблицы, заголовки, описания всех элементов вплоть до вставленных картинок с разметкой их позиции.
- Готово к дальнейшей загрузке в RAG-систему или векторную БД.


### Интеграция с визуальными моделями/описанием графиков

- Возможна работа с визуальными (Vision) моделями: локальными, коммерческими (например, OpenAI Vision)
- Можно попросить Docling делать автодескриптор изображений (описание графика, детали инфографики автоматически вставляются в Markdown как подписи)
- Код интеграции (пример с OpenAI Vision):

```python
# подключаем OpenAI Vision к Docling для описания графиков
from openai import OpenAI
...
# смотрите подробный пример в п. “Picture Description” / official doc
```


### Автоматизация и продвинутые сценарии (скрипты batch/parsing)

- Первый скрипт: парсинг одного файла → Markdown
- Второй скрипт: парсинг всех файлов из папки `documents/` с записью markdown-результатов в папку `output/`
- Третий скрипт (с Vision): автоописание графиков, вставка описаний в markdown

**Всё запускается через стандартный Python, настройки простые, повторяемые.**

***

## Доклинг в автоматизации N8N — локальный парсер через API (видео №2)

### Архитектура и развертывание

- **Docling Serve API:** официальный сервер-обёртка, разворачивается как Docker-контейнер, все функции парсинга и Hybrid Chunking доступны через REST API
- Быстрый запуск:

```bash
docker run -p 5001:5001 ghcr.io/doclingproject/docling-serve:latest
```

(проверьте свежую команду в README)
- После запуска доступен эндпойнт-конвертер `/convert`, `/chunk`, `/chunk_hybrid` и документация по адресу `http://localhost:5001/docs`


### Интеграция с n8n (No-code автоматизация)

**Основная цепочка для корпоративной обработки:**

1. **File Trigger** — отслеживание новых/изменённых файлов локально или с облачного диска (Google Drive)
2. **Чтение файла** — node “Read Binary File” в n8n
3. **HTTP Request к Docling Serve** — передать бинарник PDF/DOCX/HTML в Docling через API
    - Эндпойнты:
        - `/convert` — парсинг в markdown целиком
        - `/chunk_hybrid` — гибридный чанкинг (см. ниже)
4. **Получение Markdown/Chunked JSON** — результат автоматически обрабатывается и может быть:
    - сохранён в файловой системе
    - передан на векторизацию
    - упакован в Supabase/ClickHouse/Milvus или другую VectorDB через соответствующий node
5. **Векторизация чанков** — параллельно по каждому логическому блоку, с сохранением метаданных (имя файла, страница, заголовок, тип блока)
6. **Алгоритм обновления** — автоматизировано: любые новые файлы/изменения автоматически парсятся и обновляются в вашей векторной базе, нет дублей и “грязи”.

### Пример структуры результата c Hybrid Chunking

```json
{
  "text": "Текст этого чанка...",
  "title": "Заголовок/статья",
  "page": 3,
  "doctype": "table",
  "filename": "doc1.pdf"
}
```

- Каждый чанк (кусок текста, таблицы, секции) — самостоятельная сущность с полным контекстом, корректно отделён от других блоков.


### Гибридный чанкинг

**Что это и зачем:**

- Автоматически разбивает документ на чанки по структурным границам (заголовки, таблицы, списки, секции)
- Нет “порванных” чанков — строгие границы, все метаданные (страница, тип, заголовок) включены автоматически
- Позволяет:
    - получать корректный semantic search в векторной базе
    - строить фильтры и точные поисковые запросы
    - делать аналитику на уровне таблиц/разделов
- Особенно эффективно для сложных PDF: юридические документы, техдокументация, коммерческие офферы, презентации с графиками

***

## Конструктор no-code пайплайна в n8n

**Схема:**

```
[File Trigger]
  ↓
[Read File (Binary)]
  ↓
[HTTP → Docling (/chunk_hybrid)]
  ↓
[Split Items]   ← разбивка массива чанков на отдельные объекты
  ↓
[Vector Store Upload (Supabase, Milvus,...)] ← сохраняем с метаданными: page, section, title, type, filename
```

**Фильтрация и поиск:**

- Любые поля метаданных (страница, раздел, таблица, doctype) можно использовать для advanced фильтрации по запросу, чтобы делать релевантные semantic retrieval (пример для RAG-агентов, корпоративных ботов, юридических ассистентов).

***

## Характеристики и плюсы решения

- **100% приватность и контроль, нет утечек**
- Бесплатное использование и open-source модульность
- Возможность дополнительно подключать Vision/LLM-модели для автодескрипции (графики, изображения)
- Без ограничения по лицензии (отлично подходит для юридических и корпоративных документов)
- Идеальная масштабируемость: легко интегрируется в любые пайплайны, no/low-code системы, корпоративные решения с Supabase/Clickhouse/Milvus/Weaviate/Chroma и др.
- Гибкая настройка chunking (hybrid/manual)
- Есть поддержка advanced enrichment (описания картинок, дополнительные поля)
- Высокая устойчивость к “грязи” в документах

***

## Практические рекомендации

- Для высокой юридической или финансовой защищённости используйте полностью оффлайн-цепочки.
- Доклинг гибко расширим: пишите свои парсеры, легко встраивайте в корпоративные пайплайны.
- Для эффективного поиска используйте гибридный чанкинг + храните метаданные у каждого чанка.
- Для сложных входных данных (отсканированные документы с графиками) используйте опцию автодескрипции или подключение к Vision API.
- Сохраняйте исходные markdown/json результаты для отладки и аудита данных.

***

## Рекомендуемые ресурсы и ссылки (актуальные на ноябрь 2025)

- GitHub Docling: https://github.com/doclingproject/docling
- Документация Docling Serve (API + Docker): https://github.com/doclingproject/docling-serve
- Telegram-канал/группа с кейсами и шаблонами: https://t.me/+W1SnvvkcV6A3NWMy
- Лучшие практики по гибридному chunking и векторизации: https://github.com/quivhrq/megaparse
- OpenAI Vision integration sample: см. официальную документацию OpenAI Vision

**Последнее обновление инструкций: ноябрь 2025**

***

**Этот подход полностью соответствует требованиям по data privacy, гибкости и масштабируемости. Доклинг + n8n — оптимальный выбор для компании, где критичны приватность, отсутствие трат на API и глубоко кастомизируемый пайплайн для корпоративных ИИ-ассистентов и юридических или инженерных баз знаний.**
<span style="display:none">[^1][^2]</span>

<div align="center">⁂</div>

[^1]: https://www.youtube.com/watch?v=tawFHMNF-T8

[^2]: https://www.youtube.com/watch?v=CRNgrCZkpZE

